GEM_MAKEFILE_PATH = $(strip $(dir $(firstword $(MAKEFILE_LIST))))


.PHONY: gem

gem:
	find ./ -maxdepth 1 '*.gemspec' | xargs -n1 gem build

.PHONY: clean
clean:
	rm *.gem

.PHONY: dump
dump:
	tar --to-stdout -xf *.gem data.tar.gz | tar -zt


# Bundler stuff

.PHONY: bundle_init
bundle_init:
	bundle config set path --local "$(GEM_MAKEFILE_PATH)/.bundle"

.PHONY: bundle_install
bundle_install:
	# echo "Gem makefile path: " $(GEM_MAKEFILE_PATH)
	# bundle install --path "$(GEM_MAKEFILE_PATH)/.bundle"
	# bundle install --path "$(GEM_MAKEFILE_PATH)/vendor/bundle"
	bundle install

.PHONY: bundle_exec_rspec
	bundle exec rspec
